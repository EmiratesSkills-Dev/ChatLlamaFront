<div style="max-width:600px; margin: 30px auto;">
  <nz-card nzTitle="Chat AI" style="min-height:500px; display:flex; flex-direction:column;">
    <div style="flex:1; overflow-y:auto; margin-bottom:20px; max-height:350px;">
      <ng-container *ngFor="let msg of messages">
        <div [ngStyle]="{
          'text-align': msg.role==='user' ? 'right' : 'left',
          'margin': '10px 0'
        }">
          <nz-tag [nzColor]="msg.role==='user' ? 'blue' : 'green'">
            {{msg.role === 'user' ? 'You' : 'IA'}}
          </nz-tag>
          <span [innerHTML]="formatMessage(msg.text)"></span>
        </div>
      </ng-container>
      <nz-spin *ngIf="loading"></nz-spin>
    </div>

    <div style="display:flex; gap:10px;">
      <input nz-input [(ngModel)]="question" (keydown.enter)="send()" placeholder="Type your questions..." [disabled]="loading" />
      <button nz-button nzType="primary" (click)="send()" [disabled]="loading || !question.trim()">Send</button>
    </div>
  </nz-card>
</div>
